<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·å…´è¶£æ™ºèƒ½åˆ†æå¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .section {
            margin-bottom: 30px;
        }

        .section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-ready {
            background: #27ae60;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #34495e;
            font-weight: 600;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        button {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .data-textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #3498db;
        }

        .prompt-preview-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
            white-space: pre-wrap;
            margin-top: 10px;
        }

        #outputSection {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ç”¨æˆ·å…´è¶£æ™ºèƒ½åˆ†æå¹³å°</h1>
            <p>åŸºäºè¡Œä¸ºæ•°æ®çš„ä¸“ä¸šçº§å…´è¶£ç”»åƒåˆ†æç³»ç»Ÿ</p>
        </div>

        <div class="main-content">
            <!-- ç”¨æˆ·é€‰æ‹©åŒºåŸŸ -->
            <div class="section">
                <h3><span class="status-indicator status-ready"></span>æ­¥éª¤ 1: é€‰æ‹©ç”¨æˆ·</h3>
                <div class="form-group">
                    <label for="userSelect">é€‰æ‹©ç”¨æˆ·IDï¼š</label>
                    <select id="userSelect">
                        <option value="">-- è¯·é€‰æ‹©ç”¨æˆ· --</option>
                        <option value="user1">User1</option>
                    </select>
                </div>
                <button id="getUserBehaviorBtn" onclick="getUserBehavior()" disabled>è·å–ç”¨æˆ·è¡Œä¸ºæ•°æ®</button>
            </div>

            <!-- æ•°æ®ç¼–è¾‘åŒºåŸŸ -->
            <div class="section" id="dataSection" style="display: none;">
                <h3><span class="status-indicator status-ready"></span>æ­¥éª¤ 2: ç¼–è¾‘ç”¨æˆ·æ•°æ®</h3>
                <div class="form-group">
                    <label for="userData">ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼š</label>
                    <textarea id="userData" class="data-textarea" placeholder="ç”¨æˆ·æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º..."></textarea>
                </div>
                <div class="button-group">
                    <button id="editBtn" onclick="toggleEdit()">ç¼–è¾‘æ•°æ®</button>
                    <button id="saveBtn" onclick="saveData()" style="display: none;" class="btn-success">ä¿å­˜æ•°æ®</button>
                    <button id="cancelBtn" onclick="cancelEdit()" style="display: none;" class="btn-secondary">å–æ¶ˆç¼–è¾‘</button>
                </div>
            </div>

            <!-- æç¤ºé€‰æ‹©å’Œè¿è¡ŒåŒºåŸŸ -->
            <div class="section" id="promptSection" style="display: none;">
                <h3><span class="status-indicator status-ready"></span>æ­¥éª¤ 3: é…ç½®AIæœåŠ¡</h3>
                
                <div class="form-group">
                    <label for="aiProvider">é€‰æ‹©AIæ¨¡å‹ï¼š</label>
                    <select id="aiProvider">
                        <option value="">-- è¯·é€‰æ‹©AIæ¨¡å‹ --</option>
                        <option value="gpt-5.2">GPT-5.2</option>
                        <option value="gpt-5.1">GPT-5.1</option>
                        <option value="gpt-5">GPT-5</option>
                        <option value="o4-mini">O4-Mini</option>
                        <option value="o1-mini">O1-Mini</option>
                        <option value="local">æœ¬åœ°æ¨¡æ‹Ÿï¼ˆæµ‹è¯•ç”¨ï¼‰</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="promptSelect">é€‰æ‹©åˆ†ææ–¹æ³•ï¼š</label>
                    <select id="promptSelect">
                        <option value="">-- è¯·é€‰æ‹©åˆ†ææ–¹æ³• --</option>
                        <option value="userInterestIntelligence">ç”¨æˆ·å…´è¶£æ™ºèƒ½åˆ†æ</option>
                    </select>
                </div>
                
                <!-- æç¤ºé¢„è§ˆåŒºåŸŸ -->
                <div id="promptPreview" style="display: none;">
                    <h4>åˆ†ææ–¹æ³•é¢„è§ˆï¼š</h4>
                    <div class="prompt-preview-box"></div>
                </div>
                
                <!-- éšè—çš„æç¤ºæ•°æ®å­˜å‚¨ -->
                <textarea id="promptData" style="display: none;"></textarea>
                
                <div class="button-group">
                    <button id="runAnalysisBtn" onclick="runAnalysis()" disabled class="btn-warning">ğŸš€ è¿è¡Œåˆ†æ</button>
                </div>
            </div>

            <!-- åŠ è½½çŠ¶æ€ -->
            <div class="loading" id="loadingIndicator">ğŸ¤– æ­£åœ¨è¿›è¡Œåˆ†æ...</div>

            <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
            <div id="outputSection">
                <h3>åˆ†æç»“æœ</h3>
                <pre id="outputContent"></pre>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let isEditing = false;
        let originalData = '';

        // ç”¨æˆ·æ•°æ®
        const userData = {
            user1: `User Action Log - Daily Behavior (2026-01-13):

12:00:00 AM - MSN View: MSN homepage browsing
12:05:00 AM - Shopping: Viewed luxury handbags on designer website
12:30:00 AM - Search: "best investment strategies 2026"
01:00:00 AM - Reading: Financial news articles on Bloomberg
01:30:00 AM - Video: Watched YouTube tutorials on portfolio management
02:00:00 AM - Social: LinkedIn engagement with finance professionals
02:15:00 AM - Shopping: Browsed premium activewear brands
02:45:00 AM - Reading: Tech innovation articles
03:00:00 AM - Search: "luxury travel destinations 2026"`
        };

        // æç¤ºæ•°æ®
        const prompts = {
            userInterestIntelligence: `# User Interest Intelligence Analysis

You are a professional user behavior analyst. Analyze the provided user behavioral data and extract interest intelligence.

## Analysis Framework:
1. **Interest Identification**: Identify distinct interest categories
2. **Behavioral Patterns**: Analyze frequency and engagement depth
3. **Demographic Profiling**: Infer user characteristics from behavior
4. **Interest Duration Assessment**: Classify as emerging, growing, or stable

## Output Format:
Provide analysis in JSON format with:
- CurrentDate: Analysis date
- Demographic: User demographic profile
- Profile: Array of interests with Name, Weight, Duration, Intent, Lifecycle, Domain, Keywords, Rationale

Please analyze the user behavior data and provide comprehensive interest intelligence.`
        };

        // æ¨¡å‹é…ç½®
        const modelConfigs = {
            'gpt-5.2': { name: 'GPT-5.2', description: 'æœ€æ–°çš„GPT-5.2æ¨¡å‹', maxTokens: 4000 },
            'gpt-5.1': { name: 'GPT-5.1', description: 'GPT-5.1æ¨¡å‹', maxTokens: 4000 },
            'gpt-5': { name: 'GPT-5', description: 'GPT-5åŸºç¡€æ¨¡å‹', maxTokens: 4000 },
            'o4-mini': { name: 'O4-Mini', description: 'O4-Miniè½»é‡çº§æ¨¡å‹', maxTokens: 2000 },
            'o1-mini': { name: 'O1-Mini', description: 'O1-Miniæ¨ç†æ¨¡å‹', maxTokens: 2000 },
            'local': { name: 'æœ¬åœ°æ¨¡æ‹Ÿå™¨', description: 'ç”¨äºæµ‹è¯•çš„æ¨¡æ‹ŸAIå“åº”', maxTokens: 2000 }
        };

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åˆå§‹åŒ–å¼€å§‹');
            
            // ç”¨æˆ·é€‰æ‹©å˜åŒ–
            const userSelect = document.getElementById('userSelect');
            if (userSelect) {
                userSelect.addEventListener('change', function() {
                    const getUserBtn = document.getElementById('getUserBehaviorBtn');
                    if (getUserBtn) {
                        getUserBtn.disabled = !this.value;
                    }
                });
            }
            
            // AIæ¨¡å‹é€‰æ‹©å˜åŒ–
            const aiProvider = document.getElementById('aiProvider');
            if (aiProvider) {
                aiProvider.addEventListener('change', function() {
                    updateRunButton();
                });
            }
            
            // æç¤ºé€‰æ‹©å˜åŒ–
            const promptSelect = document.getElementById('promptSelect');
            if (promptSelect) {
                promptSelect.addEventListener('change', function() {
                    const preview = document.getElementById('promptPreview');
                    const previewBox = preview ? preview.querySelector('.prompt-preview-box') : null;
                    const promptData = document.getElementById('promptData');
                    
                    if (this.value && prompts[this.value]) {
                        if (preview) preview.style.display = 'block';
                        if (previewBox) previewBox.textContent = prompts[this.value];
                        if (promptData) promptData.value = prompts[this.value];
                    } else {
                        if (preview) preview.style.display = 'none';
                        if (previewBox) previewBox.textContent = '';
                        if (promptData) promptData.value = '';
                    }
                    
                    updateRunButton();
                });
            }
            
            console.log('é¡µé¢åˆå§‹åŒ–å®Œæˆ');
        });

        // è·å–ç”¨æˆ·è¡Œä¸ºæ•°æ®
        function getUserBehavior() {
            console.log('è·å–ç”¨æˆ·è¡Œä¸ºæ•°æ®');
            const userId = document.getElementById('userSelect').value;
            
            if (!userId) {
                alert('è¯·å…ˆé€‰æ‹©ç”¨æˆ·ID');
                return;
            }

            // æ¨¡æ‹ŸAPIè°ƒç”¨
            setTimeout(() => {
                const data = userData[userId];
                if (data) {
                    document.getElementById('userData').value = data;
                    document.getElementById('dataSection').style.display = 'block';
                    document.getElementById('promptSection').style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°æ•°æ®åŒºåŸŸ
                    document.getElementById('dataSection').scrollIntoView({ behavior: 'smooth' });
                } else {
                    alert('æœªæ‰¾åˆ°ç”¨æˆ·æ•°æ®');
                }
            }, 500);
        }

        // æ›´æ–°è¿è¡ŒæŒ‰é’®çŠ¶æ€
        function updateRunButton() {
            const aiProvider = document.getElementById('aiProvider');
            const promptSelect = document.getElementById('promptSelect');
            const runBtn = document.getElementById('runAnalysisBtn');
            
            if (aiProvider && promptSelect && runBtn) {
                const isReady = promptSelect.value && aiProvider.value;
                runBtn.disabled = !isReady;
            }
        }

        // åˆ‡æ¢ç¼–è¾‘æ¨¡å¼
        function toggleEdit() {
            const textarea = document.getElementById('userData');
            const editBtn = document.getElementById('editBtn');
            const saveBtn = document.getElementById('saveBtn');
            const cancelBtn = document.getElementById('cancelBtn');

            if (!isEditing) {
                originalData = textarea.value;
                isEditing = true;
                textarea.readOnly = false;
                textarea.style.borderColor = '#3498db';
                
                editBtn.style.display = 'none';
                saveBtn.style.display = 'inline-block';
                cancelBtn.style.display = 'inline-block';
            }
        }

        // ä¿å­˜æ•°æ®
        function saveData() {
            const textarea = document.getElementById('userData');
            const editBtn = document.getElementById('editBtn');
            const saveBtn = document.getElementById('saveBtn');
            const cancelBtn = document.getElementById('cancelBtn');

            isEditing = false;
            textarea.readOnly = true;
            textarea.style.borderColor = '#ddd';
            
            editBtn.style.display = 'inline-block';
            saveBtn.style.display = 'none';
            cancelBtn.style.display = 'none';

            alert('æ•°æ®å·²ä¿å­˜');
        }

        // å–æ¶ˆç¼–è¾‘
        function cancelEdit() {
            const textarea = document.getElementById('userData');
            const editBtn = document.getElementById('editBtn');
            const saveBtn = document.getElementById('saveBtn');
            const cancelBtn = document.getElementById('cancelBtn');

            textarea.value = originalData;
            
            isEditing = false;
            textarea.readOnly = true;
            textarea.style.borderColor = '#ddd';
            
            editBtn.style.display = 'inline-block';
            saveBtn.style.display = 'none';
            cancelBtn.style.display = 'none';
        }

        // è¿è¡Œåˆ†æ
        async function runAnalysis() {
            const userData = document.getElementById('userData').value;
            const promptSelect = document.getElementById('promptSelect').value;
            const promptData = document.getElementById('promptData').value;
            const selectedModel = document.getElementById('aiProvider').value;
            
            if (!userData || !promptSelect || !promptData || !selectedModel) {
                alert('è¯·ç¡®ä¿å·²é…ç½®æ‰€æœ‰å¿…è¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬é€‰æ‹©æ¨¡å‹');
                return;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const loading = document.getElementById('loadingIndicator');
            const outputSection = document.getElementById('outputSection');
            
            loading.style.display = 'block';
            outputSection.style.display = 'none';
            loading.textContent = `ğŸ¤– æ­£åœ¨è°ƒç”¨ ${modelConfigs[selectedModel]?.name || selectedModel} è¿›è¡Œåˆ†æ...`;

            try {
                let analysisResult;
                if (selectedModel === 'local') {
                    // æœ¬åœ°æ¨¡æ‹Ÿ
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    analysisResult = generateMockAnalysis();
                } else {
                    // çœŸå®AIè°ƒç”¨ (è¿™é‡Œéœ€è¦å®ç°)
                    analysisResult = await callGPTModels(promptData + '\n\n# USER DATA\n' + userData, selectedModel);
                }
                
                // éšè—åŠ è½½ï¼Œæ˜¾ç¤ºç»“æœ
                loading.style.display = 'none';
                outputSection.style.display = 'block';
                
                // æ˜¾ç¤ºç»“æœ
                document.getElementById('outputContent').textContent = JSON.stringify(analysisResult, null, 2);
                
                // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                outputSection.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                loading.style.display = 'none';
                alert(`åˆ†æå¤±è´¥: ${error.message}`);
            }
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿåˆ†æç»“æœ
        function generateMockAnalysis() {
            return {
                "CurrentDate": "2026-01-21",
                "Demographic": "Professional technology-oriented individual with strong interest in AI and finance, likely working in tech or financial sector.",
                "Profile": [
                    {
                        "Name": "Financial Investment",
                        "Weight": 0.85,
                        "Duration": "emerging",
                        "Intent": "educational",
                        "Lifecycle": "growth",
                        "Domain": "finance",
                        "Keywords": ["investment", "portfolio", "strategies", "financial planning"],
                        "Rationale": "Multiple searches and content consumption related to investment strategies and portfolio management indicate strong emerging interest in financial planning."
                    },
                    {
                        "Name": "Luxury Shopping",
                        "Weight": 0.72,
                        "Duration": "stable",
                        "Intent": "transactional",
                        "Lifecycle": "mature",
                        "Domain": "lifestyle",
                        "Keywords": ["luxury", "designer", "premium", "handbags", "activewear"],
                        "Rationale": "Consistent browsing of luxury items and premium brands suggests established purchasing behavior in high-end consumer goods."
                    }
                ]
            };
        }

        // è°ƒç”¨GPTæ¨¡å‹ (å ä½ç¬¦å‡½æ•°)
        async function callGPTModels(prompt, model) {
            // è¿™é‡Œåº”è¯¥å®ç°çœŸå®çš„APIè°ƒç”¨
            // æš‚æ—¶è¿”å›æ¨¡æ‹Ÿç»“æœ
            throw new Error('çœŸå®APIè°ƒç”¨åŠŸèƒ½éœ€è¦é…ç½®APIå¯†é’¥');
        }

        console.log('è„šæœ¬åŠ è½½å®Œæˆ');
    </script>
</body>
</html>