<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Interest Intelligence Analysis Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e1e5e9;
            border-radius: 12px;
            background: #f8f9fa;
        }

        .section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        select, textarea, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        select:focus, textarea:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            min-height: 150px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #5a6268);
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
        }

        .output-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .output-content {
            background: white;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            font-size: 13px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-style: italic;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
            margin-top: 10px;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            margin-top: 10px;
        }

        .edit-controls {
            display: none;
            margin-top: 10px;
        }

        .readonly {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† User Interest Intelligence Analysis Platform</h1>
            <p>AI-Based User Behavior Insights and Personalized Recommendation System</p>
        </div>

        <!-- 1.1 Áî®Êà∑ÈÄâÊã©Âå∫Âüü -->
        <div class="section">
            <h3>1. Select User ID</h3>
            <div class="form-group">
                <label for="userIdSelect">User ID:</label>
                <select id="userIdSelect">
                    <option value="">-- Please Select User ID --</option>
                    <option value="user1">user1</option>
                </select>
            </div>
            <!-- 1.2 Get User Behavior Button -->
            <button class="btn" id="getUserBehaviorBtn" onclick="getUserBehavior()" disabled>
                üìä Get User Behavior
            </button>
        </div>

        <!-- 1.3 Áî®Êà∑Êï∞ÊçÆÂ±ïÁ§∫ÂíåÁºñËæëÂå∫Âüü -->
        <div class="section" id="userDataSection" style="display: none;">
            <h3>2. User Behavior Data</h3>
            <div class="form-group">
                <label for="userDataTextarea">User Data Content:</label>
                <textarea id="userDataTextarea" class="readonly" readonly 
                    placeholder="Click the button above to get user data..."></textarea>
            </div>
            <!-- 1.4 Edit and Save Buttons -->
            <button class="btn btn-secondary" id="editBtn" onclick="enableEdit()">
                ‚úèÔ∏è Edit
            </button>
            <div class="edit-controls" id="editControls">
                <button class="btn btn-success" id="saveBtn" onclick="saveUserData()">
                    üíæ Save
                </button>
                <button class="btn btn-danger" id="cancelBtn" onclick="cancelEdit()">
                    ‚ùå Cancel
                </button>
            </div>
        </div>

        <!-- 1.5 Prompt Selection Area -->
        <div class="section" id="promptSection" style="display: none;">
            <h3>3. Select Analysis Prompt</h3>
            <div class="form-group">
                <label for="promptSelect">Prompt:</label>
                <select id="promptSelect">
                    <option value="">-- Please Select Prompt --</option>
                    <option value="user-interest-intelligence-prompt_testV1.md">user-interest-intelligence-prompt_testV1.md</option>
                </select>
            </div>
            <!-- 1.6 Run Analysis Button -->
            <button class="btn" id="runPromptBtn" onclick="runPrompt()" disabled>
                üöÄ Run Analysis
            </button>
        </div>

        <!-- 1.7 Output Results Display Area -->
        <div class="section" id="outputSection" style="display: none;">
            <h3>4. Analysis Results</h3>
            <div class="output-section">
                <div id="loadingIndicator" class="loading" style="display: none;">
                    ü§ñ Running AI Analysis...
                </div>
                <div class="output-content" id="outputContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Áî®Êà∑Êï∞ÊçÆÂ≠òÂÇ®Ôºà‰ªÖ‰Ωú‰∏∫Â§áÁî®Ôºå‰∏ªË¶Å‰ªéÊñá‰ª∂ËØªÂèñÔºâ
        const userData = {};

        // Prompt Templates
        const prompts = {
            'user-interest-intelligence-prompt_testV1.md': `# User Interest Intelligence Analysis Prompt

## Task Description
Based on the provided user behavior data, conduct deep interest intelligence analysis and output structured user profiles and personalized recommendations.

## Analysis Dimensions
1. **Interest Preference Analysis**: Identify user's core interest areas and preference levels
2. **Behavior Pattern Recognition**: Analyze user's behavioral habits and activity patterns
3. **Personalization Features**: Extract user's personalized tags and characteristics
4. **Recommendation Strategy**: Generate personalized recommendations based on analysis results

## Output Format
Please output analysis results in JSON format, containing the following fields:
- user_interests: User interest list
- behavior_patterns: Behavior pattern analysis
- personality_tags: Personalized tags
- recommendations: Personalized recommendations
- confidence_score: Analysis confidence score

## User Data
`
        };

        // 1.1 User selection event listener
        document.getElementById('userIdSelect').addEventListener('change', function() {
            const selectedUserId = this.value;
            const getUserBehaviorBtn = document.getElementById('getUserBehaviorBtn');
            
            if (selectedUserId) {
                getUserBehaviorBtn.disabled = false;
            } else {
                getUserBehaviorBtn.disabled = true;
                // Hide subsequent sections
                document.getElementById('userDataSection').style.display = 'none';
                document.getElementById('promptSection').style.display = 'none';
                document.getElementById('outputSection').style.display = 'none';
            }
        });

        // Prompt selection event listener
        document.getElementById('promptSelect').addEventListener('change', function() {
            const selectedPrompt = this.value;
            const runPromptBtn = document.getElementById('runPromptBtn');
            
            if (selectedPrompt) {
                runPromptBtn.disabled = false;
            } else {
                runPromptBtn.disabled = true;
            }
        });

        // 1.3 Get user behavior data
        async function getUserBehavior() {
            const selectedUserId = document.getElementById('userIdSelect').value;
            
            if (!selectedUserId) {
                alert('Please select a User ID first');
                return;
            }

            try {
                // ‰ºòÂÖàÂ∞ùËØïÁõ∏ÂØπË∑ØÂæÑÔºàGitHub PagesÔºâÔºåÁÑ∂ÂêéÂ∞ùËØïGitHub raw URL
                let response;
                let dataSource = 'GitHub Pages';
                
                try {
                    response = await fetch(`./user-data/${selectedUserId}.txt`);
                    if (!response.ok) throw new Error('GitHub Pages failed');
                } catch (e) {
                    console.log('GitHub Pages failed, trying GitHub Raw URL...');
                    dataSource = 'GitHub Raw';
                    response = await fetch(`https://raw.githubusercontent.com/lixin987-ship-it/user-interest-intelligence-repo/main/user-data/${selectedUserId}.txt`);
                }
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const userDataContent = await response.text();
                
                const userDataTextarea = document.getElementById('userDataTextarea');
                const userDataSection = document.getElementById('userDataSection');
                const promptSection = document.getElementById('promptSection');
                
                // Display user data
                userDataTextarea.value = userDataContent;
                userDataSection.style.display = 'block';
                promptSection.style.display = 'block';
                
                // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
                showMessage('success', `Successfully loaded ${selectedUserId} user behavior data from ${dataSource}`);
                
            } catch (error) {
                console.error('Failed to read user data:', error);
                showMessage('error', `Unable to read file user-data/${selectedUserId}.txt: ${error.message}`);
            }
        }

        // 1.4 Enable edit mode
        function enableEdit() {
            const userDataTextarea = document.getElementById('userDataTextarea');
            const editBtn = document.getElementById('editBtn');
            const editControls = document.getElementById('editControls');
            
            userDataTextarea.readOnly = false;
            userDataTextarea.classList.remove('readonly');
            editBtn.style.display = 'none';
            editControls.style.display = 'block';
            
            userDataTextarea.focus();
        }

        // 1.4 Save user data
        function saveUserData() {
            const selectedUserId = document.getElementById('userIdSelect').value;
            const userDataTextarea = document.getElementById('userDataTextarea');
            
            // Exit edit mode
            cancelEdit();
            
            showMessage('success', 'Áî®Êà∑Êï∞ÊçÆ‰øùÂ≠òÊàêÂäüÔºàÊ≥®ÊÑèÔºö‰ªÖ‰øùÂ≠òÂú®È°µÈù¢‰∏≠ÔºåÂà∑Êñ∞Âêé‰ºöÈáçÁΩÆÔºâ');
            
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†‰øùÂ≠òÂà∞Êñá‰ª∂ÁöÑÈÄªËæë
            console.log('‰øùÂ≠òÊï∞ÊçÆ:', selectedUserId, userDataTextarea.value);
        }

        // 1.4 ÂèñÊ∂àÁºñËæë
        function cancelEdit() {
            const userDataTextarea = document.getElementById('userDataTextarea');
            const editBtn = document.getElementById('editBtn');
            const editControls = document.getElementById('editControls');
            const selectedUserId = document.getElementById('userIdSelect').value;
            
            // ÊèêÁ§∫Áî®Êà∑ÈúÄË¶ÅÈáçÊñ∞Âä†ËΩΩÂéüÂßãÊï∞ÊçÆ
            if (selectedUserId) {
                showMessage('success', 'Â∑≤ÂèñÊ∂àÁºñËæëÔºåÂ¶ÇÈúÄÊÅ¢Â§çÂéüÂßãÊï∞ÊçÆËØ∑ÈáçÊñ∞ÁÇπÂáª"Get User Behavior"');
            }
            
            userDataTextarea.readOnly = true;
            userDataTextarea.classList.add('readonly');
            editBtn.style.display = 'inline-block';
            editControls.style.display = 'none';
        }

        // 1.6 ËøêË°åPromptÂàÜÊûê
        async function runPrompt() {
            const selectedPrompt = document.getElementById('promptSelect').value;
            const userDataText = document.getElementById('userDataTextarea').value;
            const outputSection = document.getElementById('outputSection');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const outputContent = document.getElementById('outputContent');
            
            if (!selectedPrompt || !userDataText.trim()) {
                alert('Please ensure Prompt is selected and user data is not empty');
                return;
            }

            // ÊòæÁ§∫ËæìÂá∫Âå∫ÂüüÂíåÂä†ËΩΩÁä∂ÊÄÅ
            outputSection.style.display = 'block';
            loadingIndicator.style.display = 'block';
            outputContent.innerHTML = '';

            try {
                // 1.6 ÊãºÊé•promptÂíåÁî®Êà∑Êï∞ÊçÆ
                const fullPrompt = prompts[selectedPrompt] + '\n\n' + userDataText;
                
                console.log('Running analysis:', {
                    prompt: selectedPrompt,
                    userDataLength: userDataText.length
                });

                // Ê®°ÊãüAIÂàÜÊûêÂ§ÑÁêÜÊó∂Èó¥
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // ÁîüÊàêÂàÜÊûêÁªìÊûú
                const analysisResult = generateAnalysisResult(userDataText);
                
                // 1.7 ‰ª•ÁÆÄÊ¥ÅÂΩ¢ÂºèÂ±ïÁ§∫ËæìÂá∫
                loadingIndicator.style.display = 'none';
                outputContent.innerHTML = formatAnalysisOutput(analysisResult);
                
                showMessage('success', 'Analysis complete!');
                
            } catch (error) {
                loadingIndicator.style.display = 'none';
                outputContent.innerHTML = `ÈîôËØØ: ${error.message}`;
                showMessage('error', 'Error occurred during analysis');
                console.error('Analysis error:', error);
            }
        }

        // ÁîüÊàêÂàÜÊûêÁªìÊûú (Ê®°ÊãüAIÂàÜÊûê)
        function generateAnalysisResult(userDataText) {
            // ÂàÜÊûêÂÆûÈôÖÁöÑÁî®Êà∑Êï∞ÊçÆÊ†ºÂºè
            const text = userDataText.toLowerCase();
            
            const interests = [];
            const patterns = [];
            const tags = [];
            const recommendations = [];
            
            // Interest identification based on data weight
            if (text.includes('fashion') || text.includes('style') || text.includes('clothing')) {
                interests.push('Fashion & Style (Weight: 0.95+)');
                tags.push('Fashion Enthusiast');
                recommendations.push('Recommend personalized fashion styling and seasonal clothing');
            }
            
            if (text.includes('technology') || text.includes('ai') || text.includes('artificial intelligence') || text.includes('copilot')) {
                interests.push('Artificial Intelligence & Technology (Weight: 0.78+)');
                tags.push('Tech Enthusiast');
                recommendations.push('Recommend latest AI technology news and tech product reviews');
            }
            
            if (text.includes('business') || text.includes('finance') || text.includes('investment')) {
                interests.push('Business & Finance (Weight: 0.77+)');
                tags.push('Investment & Finance User');
                recommendations.push('Recommend investment news and financial planning tools');
            }
            
            if (text.includes('travel') || text.includes('flight') || text.includes('airport')) {
                interests.push('Travel & Transportation (Weight: 0.80+)');
                tags.push('Travel Enthusiast');
                recommendations.push('Recommend travel destinations and flight deals');
            }
            
            if (text.includes('pets') || text.includes('animals') || text.includes('kitten') || text.includes('dog')) {
                interests.push('Pets & Animals (Weight: 0.60+)');
                tags.push('Animal Lover');
                recommendations.push('Recommend pet care and animal rescue content');
            }

            // Behavior analysis based on time patterns
            if (text.includes('long-term')) {
                patterns.push('Long-term stable interest user - has persistent preferences');
            }
            
            if (text.includes('short-term')) {
                patterns.push('Short-term active interest user - sensitive to new things');
            }
            
            // Behavior patterns based on data sources
            if (text.includes('msn') && text.includes('edge')) {
                patterns.push('Multi-platform active user - dual usage of MSN and Edge');
            }
            
            if (text.includes('uet')) {
                patterns.push('Deep shopping user - has strong purchase intention');
            }

            // Weight-based recommendation strategy
            const weightMatches = text.match(/0\.\d+/g);
            if (weightMatches) {
                const maxWeight = Math.max(...weightMatches.map(w => parseFloat(w)));
                if (maxWeight > 0.9) {
                    recommendations.push('High-weight interest identification - focus on core interest content');
                }
                if (maxWeight > 0.8) {
                    recommendations.push('Personalized algorithm optimization - based on high confidence data');
                }
            }

            // Time sensitivity analysis
            if (text.includes('2026-01-')) {
                patterns.push('Recently active user - high frequency interactions in January 2026');
                recommendations.push('Real-time content push - capture current user interest hotspots');
            }

            return {
                user_interests: interests.length > 0 ? interests : ['Diversified interest user'],
                behavior_patterns: patterns.length > 0 ? patterns : ['Standard user behavior pattern'],
                personality_tags: tags.length > 0 ? tags : ['Comprehensive user'],
                recommendations: recommendations.length > 0 ? recommendations : ['Personalized content recommendations'],
                confidence_score: '92%',
                analysis_timestamp: new Date().toLocaleString(),
                data_source: 'Microsoft-User-Behavior-Intelligence',
                data_points: text.split('\n').length,
                weight_analysis: weightMatches ? `Found ${weightMatches.length} weight data points` : 'No weight data'
            };
        }

        // 1.7 Format analysis output (concise form)
        function formatAnalysisOutput(result) {
            return `üéØ Microsoft User Interest Intelligence Analysis Report

üìä Core Interest Identification:
${result.user_interests.map(interest => `   ‚Ä¢ ${interest}`).join('\n')}

üìà User Behavior Patterns:
${result.behavior_patterns.map(pattern => `   ‚Ä¢ ${pattern}`).join('\n')}

üè∑Ô∏è User Profile Tags:
${result.personality_tags.map(tag => `   ‚Ä¢ ${tag}`).join('\n')}

üí° Personalized Recommendation Strategy:
${result.recommendations.map(rec => `   ‚Ä¢ ${rec}`).join('\n')}

üìã Analysis Metadata:
   ‚Ä¢ Analysis Confidence: ${result.confidence_score}
   ‚Ä¢ Data Source: ${result.data_source}
   ‚Ä¢ Data Points Count: ${result.data_points}
   ‚Ä¢ Weight Analysis: ${result.weight_analysis}
   ‚Ä¢ Analysis Time: ${result.analysis_timestamp}

üîç Technical Details:
   ‚Ä¢ Algorithm Version: User Interest Intelligence v2.0
   ‚Ä¢ Processing Mode: Real-time behavior data analysis
   ‚Ä¢ Data Timeliness: Current data as of 2026-01-14

---
‚úÖ Intelligence Analysis Complete | ü§ñ Microsoft AI User Interest Analysis System`;
        }

        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(type, message) {
            // ÁßªÈô§‰πãÂâçÁöÑÊ∂àÊÅØ
            const existingMessages = document.querySelectorAll('.success, .error');
            existingMessages.forEach(msg => msg.remove());
            
            const messageDiv = document.createElement('div');
            messageDiv.className = type;
            messageDiv.textContent = message;
            
            // Add to container end
            document.querySelector('.container').appendChild(messageDiv);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 3000);
        }

        console.log('User Interest Intelligence Analysis Platform loaded');
        console.log('Available User IDs:', Object.keys(userData));
        console.log('Available Prompts:', Object.keys(prompts));
    </script>
</body>
</html>